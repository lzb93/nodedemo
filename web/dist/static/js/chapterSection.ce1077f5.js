(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chapterSection"],{"0d7d":function(t,e,n){},"39a6":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"comment"},[n("div",{staticClass:"comment-header"},[t._v(" 评论列表 ")]),t.comment&&t.comment.length>0?n("ul",{staticClass:"comment-box"},t._l(t.comment,(function(e,a){return n("li",{key:a,staticClass:"comment-item"},[n("div",{staticClass:"comment-avatar"},[n("Avatar",{staticStyle:{"background-color":"#2d8cf0"},attrs:{size:"small",icon:"ios-person"}})],1),n("div",{staticClass:"comment-info"},[n("h1",{staticClass:"comment-username"},[t._v(t._s(e.nickname))]),n("p",{staticClass:"comment-content"},[t._v(" "+t._s(e.content)+" ")]),e.reply&&e.reply.length>0?n("div",{staticClass:"comment-reply"},[n("ul",{staticClass:"comment-box"},t._l(e.reply,(function(e,a){return n("li",{key:a,staticClass:"comment-item"},[n("div",{staticClass:"comment-avatar"},[n("Avatar",{staticStyle:{"background-color":"#2d8cf0"},attrs:{size:"small",icon:"ios-chatbubbles"}})],1),n("div",{staticClass:"comment-info"},[n("h1",{staticClass:"comment-username"},[t._v("来自「"+t._s(e.nickname)+"」的回复 "+t._s(e.reply_username))]),n("p",{staticClass:"comment-content"},[t._v(" "+t._s(e.content)+" ")])])])})),0)]):t._e(),n("p",{staticClass:"comment-reply-btn",on:{click:function(n){return t.reply(e.id,e.nickname)}}},[t._v("点击回复")])])])})),0):t._e(),t.page&&t.page.current_page<t.page.total_pages?n("ul",{staticClass:"load-more-comment",on:{click:t.loadMoreComment}},[n("Icon",{staticStyle:{color:"#f00"},attrs:{type:"md-ionic"}}),t._v(" 点击加载更多 ")],1):t._e(),n("Modal",{attrs:{"z-index":t.zIndex,title:t.replyNickname},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("v-comment-create",{attrs:{comment_type:t.commentType,comment_id:t.comment_id},on:{updateComment:t.updateComment}})],1)],1)},r=[],c=(n("a4d3"),n("99af"),n("4de4"),n("4160"),n("a9e3"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("d3b7"),n("284c")),o=(n("96cf"),n("2fa7")),s=n("2f62"),i=n("d2b3");function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(n,!0).forEach((function(e){Object(o["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var u={props:{target_id:{type:Number||String,default:function(){return-1}},target_type:{type:String,default:function(){return"article"}}},components:{VCommentCreate:i["a"]},computed:l({},Object(s["d"])({comment:function(t){return t.comment.commentList},page:function(t){return t.comment.commentPage}})),data:function(){return{show:!1,comment_id:0,replyNickname:"",zIndex:9999,replyArr:[],commentType:"reply",currentPage:2}},methods:l({},Object(s["b"])({getCommentList:"comment/getCommentList"}),{reply:function(t,e){this.comment_id=t,this.replyNickname="回复 「".concat(e,"」："),this.show=!this.show},updateComment:function(t,e){this.show=!this.show,this.$emit("updateComment",t,e)},loadMoreComment:function(){var t,e;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:if(!this.page||this.page.current_page===this.page.total_pages){n.next=7;break}return n.next=3,regeneratorRuntime.awrap(this.getCommentList({target_id:this.target_id,target_type:this.target_type,page:this.currentPage}));case 3:t=n.sent,e=[].concat(Object(c["a"])(this.comment),Object(c["a"])(t.data.data.data)),this.$store.commit("comment/SET_COMMENT_LIST",e),this.$store.commit("comment/SET_COMMENT_PAGE",t.data.data.meta);case 7:case"end":return n.stop()}}),null,this)}})},p=u,d=(n("efb7"),n("2877")),f=Object(d["a"])(p,a,r,!1,null,"2ef4b775",null);e["a"]=f.exports},"4d33":function(t,e,n){},"4ed9":function(t,e,n){"use strict";var a=n("4d33"),r=n.n(a);r.a},6201:function(t,e,n){"use strict";var a=n("0d7d"),r=n.n(a);r.a},9807:function(t,e,n){},"9eb0":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"chapter-detail"},[t.chapter.length>0?n("div",{staticClass:"chapter-table"},[n("h1",{staticClass:"chapter-table-title"},[n("Icon",{attrs:{type:"md-book"}}),t._v(" "+t._s(t.columnTitle)+" ")],1),n("v-column-chapter",{attrs:{chapter:t.chapter},on:{getSection:t.getSection}})],1):t._e(),t.section?n("article",{staticClass:"chapter-container"},[n("h1",{staticClass:"chapter-title"},[t._v(" "+t._s(t.section.title)+" ")]),n("ul",{staticClass:"chapter-intro"},[n("li",[n("Icon",{attrs:{size:"16",type:"ios-person-outline"}}),t._v(" "+t._s(t.section.author)+" ")],1)]),n("div",{staticClass:"chapter-content"},[n("mavon-editor",{staticStyle:{height:"100%"},attrs:{ishljs:!0,defaultOpen:"preview",editable:!1,subfield:!1,toolbarsFlag:!1},model:{value:t.section.content,callback:function(e){t.$set(t.section,"content",e)},expression:"section.content"}})],1),n("div",{staticClass:"comment-header"},[n("Icon",{attrs:{type:"ios-create-outline"}}),t._v(" 欢迎评论 ")],1),n("v-comment-create",{attrs:{target_type:"column",target_id:parseInt(t.sectionId)},on:{updateComment:t.updateComment}}),t.section&&t.section.section_comment&&t.section.section_comment.data.length>0?n("div",[n("v-comment-list",{attrs:{target_id:parseInt(t.sectionId),target_type:"column"},on:{updateComment:t.updateComment}})],1):t._e()],1):t._e()])},r=[],c=(n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("d3b7"),n("96cf"),n("2fa7")),o=n("2f62"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[t.chapter.length>0?n("div",{staticClass:"column-chapter"},t._l(t.chapter,(function(e,a){return n("dl",{key:a},[n("dt",[n("Icon",{attrs:{type:"md-list"}}),t._v(" 第 "+t._s(a+1)+" 章："+t._s(e.title)+" ")],1),e.chapter_section?n("div",t._l(e.chapter_section,(function(e,a){return n("dd",{key:a,on:{click:function(n){return t.getSection(e.id)}}},[n("h1",[n("Icon",{attrs:{type:"md-git-commit"}}),t._v(" "+t._s(e.title)+" ")],1),n("span")])})),0):t._e()])})),0):t._e()])},i=[],m={props:{chapter:{type:Array,default:function(){return[]}}},name:"Chapter",data:function(){return{sectionIndex:0}},methods:{getSection:function(t){window.scroll(0,0),this.$store.commit("chapter-section/SET_COLUMN_CHAPTER_SECTION",null),this.$store.commit("comment/SET_COMMENT_LIST",[]),this.$store.commit("comment/SET_COMMENT_PAGE",null),this.$emit("getSection",t)}}},l=m,u=(n("d01c"),n("2877")),p=Object(u["a"])(l,s,i,!1,null,"b0b152c0",null),d=p.exports,f=n("39a6"),h=n("d2b3");function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(n,!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={components:{VColumnChapter:d,VCommentList:f["a"],VCommentCreate:h["a"]},name:"chapterSection",computed:g({},Object(o["d"])({section:function(t){return t["chapter-section"].section}})),data:function(){return{content:"呢绒",sectionId:this.$route.query.sectionId,columnId:this.$route.query.columnId,chapter:[],columnTitle:""}},created:function(){this.fetchData(),this.getSection()},methods:g({},Object(o["b"])({getColumnChapter:"column-chapter/list",getSectionDetail:"chapter-section/detail"}),{fetchData:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.getColumnChapter({column_id:this.columnId}));case 2:t=e.sent,this.columnTitle=t.data.data.title,this.chapter=t.data.data.chapter_list;case 5:case"end":return e.stop()}}),null,this)},getSection:function(t){var e;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.getSectionDetail({id:t||this.sectionId}));case 2:e=n.sent,this.$store.commit("comment/SET_COMMENT_LIST",e.data.data.section_comment.data),this.$store.commit("comment/SET_COMMENT_PAGE",e.data.data.section_comment.meta);case 5:case"end":return n.stop()}}),null,this)},updateComment:function(){this.getSection()}})},y=_,v=(n("4ed9"),Object(u["a"])(y,a,r,!1,null,"053a8e65",null));e["default"]=v.exports},cef5:function(t,e,n){},d01c:function(t,e,n){"use strict";var a=n("9807"),r=n.n(a);r.a},d2b3:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"comment-create"},[n("Form",{ref:"params",attrs:{model:t.params,rules:t.ruleValidate,"label-position":"left","label-width":80}},[n("FormItem",{attrs:{label:"昵称",prop:"nickname"}},[n("Input",{attrs:{placeholder:"请输入您的昵称"},model:{value:t.params.nickname,callback:function(e){t.$set(t.params,"nickname",e)},expression:"params.nickname"}})],1),n("FormItem",{attrs:{label:"邮箱",prop:"email"}},[n("Input",{attrs:{placeholder:"请输入您的邮箱（不会被公开）"},model:{value:t.params.email,callback:function(e){t.$set(t.params,"email",e)},expression:"params.email"}})],1),n("FormItem",{attrs:{label:"评论",prop:"content"}},[n("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入您的评论内容..."},model:{value:t.params.content,callback:function(e){t.$set(t.params,"content",e)},expression:"params.content"}})],1),n("FormItem",[n("Button",{on:{click:function(e){return t.resetCommentInput("params")}}},[t._v("清空")]),n("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(e){return t.submit("params")}}},[t._v(" "+t._s("comment"===t.comment_type?"评论":"回复")+" ")])],1)],1)],1)},r=[],c=(n("a4d3"),n("4de4"),n("4160"),n("a9e3"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("d3b7"),n("96cf"),n("2fa7")),o=n("2f62");function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(n,!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={props:{target_id:{type:Number,default:function(){return 0}},target_type:{type:String,default:function(){return"article"}},comment_type:{type:String,default:function(){return"comment"}},comment_id:{type:Number,default:function(){return 0}}},data:function(){return{params:{nickname:"",email:"",content:""},ruleValidate:{nickname:[{required:!0,message:"请输入您的昵称",trigger:"blur"}],email:[{required:!0,message:"请输入您的邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],content:[{required:!0,message:"请输入评论",trigger:"blur"},{type:"string",min:2,message:"评论不能少于2个字",trigger:"blur"}]}}},methods:i({},Object(o["b"])({createComment:"comment/createComment",createReply:"reply/createReply"}),{submit:function(t){var e=this;this.$refs[t].validate((function(t){var n,a;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:if(!t){r.next=27;break}if(r.prev=1,"comment"!==e.comment_type){r.next=12;break}return e.params.target_id=e.target_id,e.params.target_type=e.target_type,r.next=7,regeneratorRuntime.awrap(e.createComment(e.params));case 7:n=r.sent,e.$emit("updateComment",n.data.data,"comment"),e.$Message.success("评论成功！"),r.next=19;break;case 12:if("reply"!==e.comment_type){r.next=19;break}return e.params.comment_id=e.comment_id,r.next=16,regeneratorRuntime.awrap(e.createReply(e.params));case 16:a=r.sent,e.$emit("updateComment",a.data.data,"reply"),e.$Message.success("回复成功！");case 19:e.resetCommentInput("params"),r.next=25;break;case 22:r.prev=22,r.t0=r["catch"](1),console.log(r.t0);case 25:r.next=28;break;case 27:e.$Message.error("表单验证失败!");case 28:case"end":return r.stop()}}),null,null,[[1,22]])}))},resetCommentInput:function(t){this.$refs[t].resetFields()}})},l=m,u=(n("6201"),n("2877")),p=Object(u["a"])(l,a,r,!1,null,"35ac3820",null);e["a"]=p.exports},efb7:function(t,e,n){"use strict";var a=n("cef5"),r=n.n(a);r.a}}]);