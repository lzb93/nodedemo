webpackJsonp([14],{"A/oQ":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("Xxa5"),o=r.n(a),i=r("exGp"),n=r.n(i),s=r("Dd8w"),c=r.n(s),l=r("NYxO"),d=r("g1wi"),u={data:function(){return{token:"",id:this.$route.params.id,detail:null,categoryList:[],formValidate:{title:"",author:"",category_id:"",cover:"",content:"",description:""},ruleValidate:{title:[{required:!0,message:"文章标题不能为空",trigger:"blur"}],author:[{required:!0,message:"文章作者不能为空",trigger:"blur"}],cover:[{required:!0,message:"文章封面不能为空",trigger:"blur"}],description:[{required:!0,message:"文章简介不能为空",trigger:"blur"}],content:[{required:!0,message:"文章内容不能为空",trigger:"blur"}]}}},created:function(){this._getArticle(),this._getCategoryList(),this._getUploadToken()},methods:c()({},Object(l.b)({getArticle:"article/getArticle",updateArticle:"article/updateArticle",getCategoryList:"category/getCategoryList"}),{uploadSuccess:function(t){var e="http://cdn.boblog.com/"+t.key;this.formValidate.cover=e,this.$Message.success("上传成功!")},uploadError:function(t){this.$Message.success("上传失败!"),console.log(t)},_getUploadToken:function(){var t=this;return n()(o.a.mark(function e(){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.a)();case 3:r=e.sent,t.token=r.token,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()},_getArticle:function(){var t=this;return n()(o.a.mark(function e(){var r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getArticle({id:t.id});case 3:r=e.sent,a=r.data.data,t.formValidate.title=a.title,t.formValidate.author=a.author,t.formValidate.category_id=parseInt(a.category_id),t.formValidate.cover=a.cover,t.formValidate.content=a.content,t.formValidate.description=a.description,e.next=15;break;case 13:e.prev=13,e.t0=e.catch(0);case 15:case"end":return e.stop()}},e,t,[[0,13]])}))()},_getCategoryList:function(){var t=this;return n()(o.a.mark(function e(){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCategoryList();case 2:r=e.sent,t.categoryList=r.data.data;case 4:case"end":return e.stop()}},e,t)}))()},_updateArticle:function(){var t=this;return n()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.formValidate.id=t.id,e.prev=1,e.next=4,t.updateArticle(t.formValidate);case 4:t.$Message.success("更新成功!"),t.$router.push("/article"),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:case"end":return e.stop()}},e,t,[[1,8]])}))()},handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){t?e._updateArticle():e.$Message.error("请完成表单!")})},handleReset:function(t){this.$refs[t].resetFields()}})},p={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",[r("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[r("FormItem",{attrs:{label:"文章标题",prop:"title"}},[r("Input",{attrs:{placeholder:"文章标题"},model:{value:t.formValidate.title,callback:function(e){t.$set(t.formValidate,"title",e)},expression:"formValidate.title"}})],1),t._v(" "),r("FormItem",{attrs:{label:"文章作者",prop:"author"}},[r("Input",{attrs:{placeholder:"文章作者"},model:{value:t.formValidate.author,callback:function(e){t.$set(t.formValidate,"author",e)},expression:"formValidate.author"}})],1),t._v(" "),r("FormItem",{attrs:{label:"文章简介",prop:"description"}},[r("Input",{attrs:{placeholder:"文章简介"},model:{value:t.formValidate.description,callback:function(e){t.$set(t.formValidate,"description",e)},expression:"formValidate.description"}})],1),t._v(" "),t.categoryList.length>0?r("FormItem",{attrs:{label:"文章分类"}},[r("Select",{model:{value:t.formValidate.category_id,callback:function(e){t.$set(t.formValidate,"category_id",e)},expression:"formValidate.category_id"}},t._l(t.categoryList,function(e,a){return r("Option",{key:a,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1):t._e(),t._v(" "),r("FormItem",{attrs:{label:"文章封面",prop:"cover"}},[r("div",{staticClass:"cover"},[r("div",{staticClass:"upload"},[r("Upload",{attrs:{multiple:"",type:"drag",action:"http://up-z2.qiniu.com","show-upload-list":!1,"on-success":t.uploadSuccess,"on-error":t.uploadError,data:{token:t.token}}},[r("div",{staticStyle:{padding:"20px 0"}},[r("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),t._v(" "),r("p",[t._v("点击或者拖拽上传")])],1)])],1),t._v(" "),r("div",{staticClass:"article-cover"},[r("img",{attrs:{src:t.formValidate.cover,alt:"cover"}})])])]),t._v(" "),r("FormItem",{attrs:{label:"文章内容",prop:"content"}},[r("mavon-editor",{ref:"md",attrs:{ishljs:!0},model:{value:t.formValidate.content,callback:function(e){t.$set(t.formValidate,"content",e)},expression:"formValidate.content"}})],1),t._v(" "),r("FormItem",[r("Button",{on:{click:function(e){return t.handleReset("formValidate")}}},[t._v("重置")]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var f=r("VU/8")(u,p,!1,function(t){r("lHPS")},"data-v-2a62d894",null);e.default=f.exports},lHPS:function(t,e){}});
//# sourceMappingURL=14.cd96a9b8d19ce8b16ea9.js.map